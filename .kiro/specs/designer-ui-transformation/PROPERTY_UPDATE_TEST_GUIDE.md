# 属性更新功能测试指南

## 修复内容

已修复设计器中属性面板配置不生效的问题，现在所有配置都能正确应用到组件上。

## 修复的功能

### 1. 样式配置

- ✅ 尺寸配置（宽度、高度、最小/最大尺寸）
- ✅ 内外边距配置
- ✅ Flex 布局配置
- ✅ 定位配置
- ✅ 字体配置
- ✅ 边框配置
- ✅ 圆角配置
- ✅ 背景配置

### 2. 基本属性

- ✅ 组件名称
- ✅ 组件特定属性（如按钮文字、文本内容等）
- ✅ 自定义属性（props）
- ✅ CSS 类名

## 测试步骤

### 测试 1：按钮组件样式更新

1. **启动设计器**

   ```bash
   npm run dev
   ```

2. **添加按钮组件**

   - 从左侧组件库拖拽一个"按钮"组件到画布
   - 点击选中该按钮

3. **测试尺寸配置**

   - 在右侧属性面板，切换到"样式"标签
   - 展开"尺寸配置"
   - 修改宽度为 "300px"
   - ✅ 验证：按钮应立即变宽到 300px
   - 修改高度为 "50px"
   - ✅ 验证：按钮应立即变高到 50px

4. **测试内外边距**

   - 展开"内外边距"
   - 修改上内边距为 "20px"
   - ✅ 验证：按钮内部上方应有 20px 的空白
   - 修改左外边距为 "30px"
   - ✅ 验证：按钮左侧应有 30px 的外边距

5. **测试字体配置**

   - 展开"字体配置"
   - 修改字体大小为 "18px"
   - ✅ 验证：按钮文字应变大
   - 修改字体颜色为红色 (#ff0000)
   - ✅ 验证：按钮文字应变为红色
   - 修改字体粗细为 "700"
   - ✅ 验证：按钮文字应变粗

6. **测试边框配置**

   - 展开"边框配置"
   - 边框位置选择"全部"
   - 边框样式选择"实线"
   - 边框宽度设置为 "2px"
   - 边框颜色设置为蓝色 (#0000ff)
   - ✅ 验证：按钮应显示 2px 的蓝色实线边框

7. **测试圆角配置**

   - 展开"圆角配置"
   - 统一圆角设置为 "10px"
   - ✅ 验证：按钮四个角应变圆

8. **测试背景配置**
   - 展开"背景配置"
   - 亮色主题背景色设置为黄色 (#ffff00)
   - ✅ 验证：按钮背景应变为黄色

### 测试 2：按钮组件基本属性更新

1. **测试组件名称**

   - 切换到"基本"标签
   - 展开"基本信息"
   - 修改组件名称为 "提交按钮"
   - ✅ 验证：左侧大纲树中应显示"提交按钮"

2. **测试按钮文字**
   - 在"扩展属性"中，修改 JSON：
   ```json
   {
     "text": "点击提交"
   }
   ```
   - ✅ 验证：按钮上的文字应变为"点击提交"

### 测试 3：文本组件（Span）

1. **添加文本组件**

   - 从组件库拖拽一个"文本"组件到画布
   - 点击选中该文本

2. **测试文本内容**

   - 在"基本"标签的"扩展属性"中修改：

   ```json
   {
     "text": "这是一段测试文本"
   }
   ```

   - ✅ 验证：文本内容应更新

3. **测试文本样式**
   - 切换到"样式"标签
   - 修改字体大小为 "24px"
   - ✅ 验证：文字应变大
   - 修改字体颜色为绿色
   - ✅ 验证：文字应变绿
   - 修改文字对齐为"居中对齐"
   - ✅ 验证：文字应居中显示

### 测试 4：容器组件（Flex）

1. **添加 Flex 容器**

   - 从组件库拖拽一个"弹性布局"组件到画布
   - 点击选中该容器

2. **测试容器尺寸**

   - 修改宽度为 "500px"
   - 修改高度为 "300px"
   - ✅ 验证：容器尺寸应改变

3. **测试 Flex 布局**

   - 展开"Flex布局"
   - Flex方向选择"纵向"
   - ✅ 验证：如果容器内有子元素，应纵向排列
   - 主轴对齐选择"居中对齐"
   - ✅ 验证：子元素应在主轴上居中
   - 列间距设置为 "20px"
   - ✅ 验证：子元素之间应有 20px 间距

4. **测试背景色**
   - 展开"背景配置"
   - 设置背景色为浅灰色 (#f0f0f0)
   - ✅ 验证：容器背景应变为浅灰色

### 测试 5：图片组件

1. **添加图片组件**

   - 从组件库拖拽一个"图片"组件到画布
   - 点击选中该图片

2. **测试图片尺寸**

   - 修改宽度为 "200px"
   - 修改高度为 "150px"
   - ✅ 验证：图片尺寸应改变

3. **测试边框和圆角**
   - 添加 2px 的边框
   - 设置圆角为 "8px"
   - ✅ 验证：图片应有圆角边框

### 测试 6：撤销/重做功能

1. **进行多次属性修改**

   - 选择一个组件
   - 修改宽度
   - 修改高度
   - 修改背景色

2. **测试撤销**

   - 点击工具栏的"撤销"按钮（或按 Ctrl+Z）
   - ✅ 验证：最后一次修改应被撤销
   - 再次点击撤销
   - ✅ 验证：倒数第二次修改应被撤销

3. **测试重做**
   - 点击工具栏的"重做"按钮（或按 Ctrl+Y）
   - ✅ 验证：刚才撤销的修改应被恢复

### 测试 7：保存和加载

1. **修改多个组件的属性**

   - 修改按钮的样式
   - 修改文本的内容
   - 修改容器的布局

2. **保存设计**

   - 点击"保存"按钮
   - ✅ 验证：应显示"保存成功"提示
   - ✅ 验证：未保存标记应消失

3. **刷新页面**
   - 刷新浏览器
   - ✅ 验证：所有修改的属性应被保留（注：当前保存功能可能未完全实现）

## 常见问题排查

### 问题 1：属性修改后组件没有变化

**可能原因：**

- 组件未被选中
- 属性值格式不正确
- 浏览器缓存问题

**解决方法：**

1. 确保组件被选中（有蓝色选择框）
2. 检查控制台是否有错误信息
3. 尝试刷新页面
4. 清除浏览器缓存

### 问题 2：选择框位置不正确

**可能原因：**

- 组件尺寸变化后选择框未更新

**解决方法：**

- 重新点击选择组件
- 如果问题持续，这是另一个需要修复的问题

### 问题 3：某些属性不生效

**可能原因：**

- 属性冲突（如同时设置了 padding 和 paddingTop）
- CSS 优先级问题

**解决方法：**

- 检查是否有冲突的属性设置
- 查看浏览器开发者工具中的 Computed 样式

## 控制台日志

修改属性时，控制台应显示以下日志：

```
属性更新: layout Object { width: "300px", height: "50px", ... }
layout 已转换并更新到 styles: Object { width: "300px", height: "50px" }
已更新属性: layout
```

如果看到这些日志，说明属性更新功能正常工作。

## 成功标准

- ✅ 所有样式配置都能实时生效
- ✅ 组件名称可以修改并在大纲树中显示
- ✅ 组件特定属性（如按钮文字）可以修改
- ✅ 修改后立即在画布中看到效果
- ✅ 撤销/重做功能正常
- ✅ 控制台没有错误信息
- ✅ 用户体验流畅，无明显延迟

## 下一步

如果所有测试都通过，可以继续测试：

1. 选择框位置修复（NEXT_SESSION_TASKS.md 中的任务 1）
2. 添加缺失的组件定义（NEXT_SESSION_TASKS.md 中的任务 3）
3. 数据绑定功能（data-binding-feature 规范）

## 相关文档

- [属性更新修复方案](./PROPERTY_UPDATE_FIX.md)
- [下一个会话任务清单](./NEXT_SESSION_TASKS.md)
- [设计器快速开始指南](./QUICK_START.md)
