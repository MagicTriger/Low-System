# 快速测试指南 - 路由隔离和布局更新

## 🚀 快速启动

```bash
# 启动开发服务器
npm run dev
```

---

## ✅ 测试清单

### 1. 设计端布局测试 (5分钟)

#### 步骤 1: 访问设计端

```
URL: http://localhost:5173/designer/resource
```

#### 检查项:

- [ ] 头部标题显示 "资源管理" (不是 "低代码设计平台")
- [ ] 头部背景色为深灰蓝色 (#2f4050)
- [ ] 侧边栏背景色为深灰蓝色 (#2f4050)
- [ ] 侧边栏顶部显示用户头像区域
- [ ] 点击折叠按钮,用户头像正常切换大小

#### 预期效果:

```
┌─────────────────────────────────────────┐
│  ☰  资源管理          🔔 ⚙️ 👤         │ ← 深灰蓝色背景 (#2f4050)
├─────────────────────────────────────────┤
│ 👤      │                               │
│ 用户名   │                               │
│ 角色     │      资源管理内容区域          │
├─────────┤                               │
│ 📁 资源  │                               │
│ 🎨 设计  │                               │
│ 👁️ 预览  │                               │
└─────────┴───────────────────────────────┘
  ↑ 深灰蓝色背景 (#2f4050)
```

---

### 2. 路由隔离测试 (10分钟)

#### 测试 A: 设计端路由

```bash
# 1. 根路径重定向
访问: http://localhost:5173/
预期: 自动跳转到 /designer/resource 或 /designer/login

# 2. 设计端登录页
访问: http://localhost:5173/designer/login
预期: 显示设计端登录页面

# 3. 资源管理页
访问: http://localhost:5173/designer/resource
预期: 显示资源管理页面 (需要登录)

# 4. 设计器页面
访问: http://localhost:5173/designer/resource/test-page
预期: 显示设计器编辑页面

# 5. 预览页面
访问: http://localhost:5173/preview/123
预期: 显示预览页面 (无需登录)

# 6. 设计端 404
访问: http://localhost:5173/designer/not-exist
预期: 显示设计端 404 页面
```

#### 测试 B: 管理端路由

```bash
# 1. 管理端登录页
访问: http://localhost:5173/admin/login
预期: 显示管理端登录页面

# 2. 管理端仪表板
访问: http://localhost:5173/admin/dashboard
预期: 显示仪表板 (需要登录)

# 3. 管理端 404
访问: http://localhost:5173/admin/not-exist
预期: 显示管理端 404 页面
```

#### 检查项:

- [ ] 设计端和管理端路由互不干扰
- [ ] 各自的 404 页面正确显示
- [ ] 登录页路径正确 (/designer/login vs /admin/login)
- [ ] 路由守卫正常工作

---

### 3. 认证隔离测试 (5分钟)

#### 步骤 1: 打开浏览器控制台

```javascript
// 查看当前 localStorage
console.log('设计端 token:', localStorage.getItem('token'))
console.log('管理端 token:', localStorage.getItem('access_token'))
```

#### 步骤 2: 模拟设计端登录

```javascript
// 设置设计端 token
localStorage.setItem('token', 'designer-test-token')

// 刷新页面
location.reload()
```

#### 步骤 3: 访问设计端页面

```
访问: http://localhost:5173/designer/resource
预期: 可以正常访问 (因为有 token)
```

#### 步骤 4: 访问管理端页面

```
访问: http://localhost:5173/admin/dashboard
预期: 跳转到 /admin/login (因为没有 access_token)
```

#### 检查项:

- [ ] 设计端使用 `token` 进行认证
- [ ] 管理端使用 `access_token` 进行认证
- [ ] 两个系统的认证状态互不影响

---

### 4. 视觉对比测试 (5分钟)

#### 并排对比

打开两个浏览器窗口:

**窗口 1 - 设计端**:

```
http://localhost:5173/designer/resource
```

**窗口 2 - 管理端**:

```
http://localhost:5173/admin/dashboard
```

#### 对比检查:

| 项目       | 设计端     | 管理端     | 是否一致 |
| ---------- | ---------- | ---------- | -------- |
| 头部标题   | "资源管理" | "管理后台" | ❌ 不同  |
| 头部背景   | #2f4050    | #ffffff    | ❌ 不同  |
| 侧边栏背景 | #2f4050    | #2f4050    | ✅ 相同  |
| 用户头像   | 显示       | 显示       | ✅ 相同  |
| 图标库按钮 | 显示       | 不显示     | ❌ 不同  |

---

## 🐛 常见问题排查

### 问题 1: 用户头像不显示

**原因**: 用户信息未设置

**解决方案**:

```javascript
// 在浏览器控制台执行
localStorage.setItem('username', '测试用户')

// 刷新页面
location.reload()
```

### 问题 2: 路由跳转到错误的登录页

**检查**:

- 设计端应该跳转到 `/designer/login`
- 管理端应该跳转到 `/admin/login`

**解决方案**:

```bash
# 清除缓存并重新构建
npm run dev -- --force
```

### 问题 3: 背景色没有改变

**检查**:

1. 浏览器缓存是否清除
2. CSS 是否正确加载

**解决方案**:

```bash
# 硬刷新浏览器
Ctrl + Shift + R (Windows/Linux)
Cmd + Shift + R (Mac)
```

### 问题 4: 404 页面显示错误

**检查**:

- 访问 `/designer/xxx` 应该显示设计端 404
- 访问 `/admin/xxx` 应该显示管理端 404

**解决方案**:

```bash
# 检查路由配置
cat src/modules/designer/router/index.ts
cat src/modules/admin/router/index.ts
```

---

## 📊 测试结果记录

### 测试环境

- 浏览器: ******\_\_\_******
- 日期: ******\_\_\_******
- 测试人: ******\_\_\_******

### 测试结果

#### 设计端布局

- [ ] 标题正确
- [ ] 头部背景色正确
- [ ] 侧边栏背景色正确
- [ ] 用户头像显示正常

#### 路由隔离

- [ ] 设计端路由正常
- [ ] 管理端路由正常
- [ ] 404 处理正确
- [ ] 登录页路径正确

#### 认证隔离

- [ ] Token 隔离正常
- [ ] 路由守卫正常
- [ ] 认证状态独立

#### 视觉效果

- [ ] 颜色符合预期
- [ ] 布局协调美观
- [ ] 响应式正常

---

## ✅ 验收标准

### 必须通过的测试

1. **布局测试**

   - ✅ 设计端标题为 "资源管理"
   - ✅ 头部和侧边栏背景色为 #2f4050
   - ✅ 用户头像正常显示

2. **路由隔离测试**

   - ✅ 设计端路由前缀为 `/designer`
   - ✅ 管理端路由前缀为 `/admin`
   - ✅ 各自的 404 页面正确

3. **认证隔离测试**
   - ✅ 设计端使用 `token`
   - ✅ 管理端使用 `access_token`
   - ✅ 认证状态互不影响

### 可选测试

- 🔲 路由切换动画流畅
- 🔲 用户信息动态更新
- 🔲 权限检查正常
- 🔲 错误处理完善

---

## 🎉 测试完成

如果所有必须通过的测试都通过,说明:

✅ **设计端布局更新成功**
✅ **路由隔离配置正确**
✅ **认证系统独立运行**
✅ **视觉效果符合预期**

可以进入下一阶段的开发! 🚀

---

**文档版本**: 1.0  
**最后更新**: 2025-10-15  
**预计测试时间**: 25 分钟
