const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Designer.DTlVBRjO.js","assets/js/vendor.BT0Of-np.js","assets/js/antdv.B3VvJiRs.js","assets/css/antdv.B6snAd4S.css","assets/css/Designer.BWEherhZ.css","assets/css/Icon.CTMPZwXS.css","assets/js/DesignerTest.CuGvBXwu.js","assets/css/DesignerTest.BVntbmCx.css","assets/js/Preview.BrZvWUA6.js","assets/js/Icon.BM9XfUDI.js","assets/css/Preview.BwAgA8-0.css","assets/js/Login.CrN9F06U.js","assets/css/Login.C_i3LJbH.css","assets/js/NotFound.B6y6t685.js","assets/css/NotFound.DHY3OvWb.css"])))=>i.map(i=>d[i]);
var be=Object.defineProperty;var we=(s,e,t)=>e in s?be(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var l=(s,e,t)=>we(s,typeof e!="symbol"?e+"":e,t);import{bm as ee,h as v,f,d as G,bn as P,bo as R,bp as C,z as U,bq as ue,br as _e,w as Z,e as D,o as te,b as de,bs as Q,F as X,p as $,bt as B,bu as Ee,bv as Se,u as Te,bw as H,bx as J,by as Oe,V as Ce,bz as ie,bd as Re,bA as Ae,bB as ke,bC as De,bD as Ve}from"./vendor.BT0Of-np.js";import{a as Y,b as Ie,A as xe}from"./antdv.B3VvJiRs.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();const re={title:"企业级低代码平台",logo:"/logo.svg",version:"1.0.0",apiUrl:"http://localhost:3000/api",theme:{primaryColor:"#1890ff",darkMode:!1,compactMode:!1}},_={STORAGE_KEYS:{USER_INFO:"user_info",TOKEN:"access_token",THEME:"theme_config",LANGUAGE:"language"},DEFAULTS:{PAGE_SIZE:20,TIMEOUT:3e4,DEBOUNCE_DELAY:300},CONTROL_TYPES:{COMMON:"common",INPUT:"input",CONTAINER:"container",COLLECTION:"collection",CHART:"chart",BI:"bi",SVG:"svg",MOBILE:"mobile",CUSTOM:"custom"},EVENT_TYPES:{CONTROL:"control",DATA_SOURCE:"dataSource",DATA_TRANSFER:"dataTransfer",GLOBAL:"global"},DATA_SOURCE_TYPES:{API:"api",STATIC:"static",MOCK:"mock"},HTTP_METHODS:{GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE",PATCH:"PATCH"},HTTP_STATUS:{OK:200,CREATED:201,NO_CONTENT:204,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,INTERNAL_SERVER_ERROR:500}},A={NETWORK_ERROR:"网络连接失败，请检查网络设置",SERVER_ERROR:"服务器内部错误，请联系管理员",UNAUTHORIZED:"登录已过期，请重新登录",FORBIDDEN:"权限不足，无法访问该资源",NOT_FOUND:"请求的资源不存在",VALIDATION_ERROR:"数据验证失败，请检查输入内容",UNKNOWN_ERROR:"未知错误，请稍后重试"},he=ee("theme",()=>{const s=v("#1890ff"),e=v(!1),t=v(!1),r=f(()=>({primaryColor:s.value,darkMode:e.value,compactMode:t.value})),a=()=>{const p=localStorage.getItem(_.STORAGE_KEYS.THEME);if(p)try{const E=JSON.parse(p);s.value=E.primaryColor,e.value=E.darkMode,t.value=E.compactMode}catch(E){console.warn("主题配置解析失败:",E)}b()},o=p=>{s.value=p,b(),S()},n=p=>{e.value=p,b(),S()},i=p=>{t.value=p,b(),S()},h=()=>{n(!e.value)},y=()=>{i(!t.value)},b=()=>{const p=document.documentElement;p.style.setProperty("--primary-color",s.value),e.value?(p.setAttribute("data-theme","dark"),document.body.classList.add("dark")):(p.removeAttribute("data-theme"),document.body.classList.remove("dark")),t.value?(p.setAttribute("data-size","compact"),document.body.classList.add("compact")):(p.removeAttribute("data-size"),document.body.classList.remove("compact"))},S=()=>{localStorage.setItem(_.STORAGE_KEYS.THEME,JSON.stringify(r.value))};return{primaryColor:s,darkMode:e,compactMode:t,themeConfig:r,init:a,setPrimaryColor:o,setDarkMode:n,setCompactMode:i,toggleDarkMode:h,toggleCompactMode:y,resetTheme:()=>{s.value="#1890ff",e.value=!1,t.value=!1,b(),S()}}},{persist:{key:_.STORAGE_KEYS.THEME,storage:localStorage}}),Ne=G({__name:"AppWrapper",setup(s){const e=he(),t=f(()=>["app-wrapper",{dark:e.darkMode,compact:e.compactMode}]);return(r,a)=>{const o=P("router-view");return C(),R("div",{id:"app",class:ue(t.value)},[U(o)],2)}}}),ae=(s,e)=>{const t=s.__vccOpts||s;for(const[r,a]of e)t[r]=a;return t},Pe=ae(Ne,[["__scopeId","data-v-7acb784f"]]),V=_e.create({baseURL:re.apiUrl,timeout:_.DEFAULTS.TIMEOUT,headers:{"Content-Type":"application/json"}});V.interceptors.request.use(s=>{const e=fe();return e.token&&(s.headers.Authorization=`Bearer ${e.token}`),s.headers["X-Request-ID"]=Ue(),s.method==="get"&&(s.params={...s.params,_t:Date.now()}),s},s=>(console.error("请求拦截器错误:",s),Promise.reject(s)));V.interceptors.response.use(s=>{const{data:e}=s;if(e.code!==_.HTTP_STATUS.OK){const t=e.message||A.UNKNOWN_ERROR;switch(e.code){case _.HTTP_STATUS.UNAUTHORIZED:le();break;case _.HTTP_STATUS.FORBIDDEN:Ie.error({message:"权限不足",description:A.FORBIDDEN});break;default:Y.error(t)}return Promise.reject(new Error(t))}return s},s=>{if(console.error("响应拦截器错误:",s),!s.response)return Y.error(A.NETWORK_ERROR),Promise.reject(s);const{status:e,data:t}=s.response;let r=A.UNKNOWN_ERROR;switch(e){case _.HTTP_STATUS.BAD_REQUEST:r=(t==null?void 0:t.message)||A.VALIDATION_ERROR;break;case _.HTTP_STATUS.UNAUTHORIZED:r=A.UNAUTHORIZED,le();break;case _.HTTP_STATUS.FORBIDDEN:r=A.FORBIDDEN;break;case _.HTTP_STATUS.NOT_FOUND:r=A.NOT_FOUND;break;case _.HTTP_STATUS.INTERNAL_SERVER_ERROR:r=A.SERVER_ERROR;break;default:r=(t==null?void 0:t.message)||A.UNKNOWN_ERROR}return e!==_.HTTP_STATUS.UNAUTHORIZED&&Y.error(r),Promise.reject(s)});function le(){fe().logout(),window.location.pathname!=="/login"&&(window.location.href="/login")}function Ue(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}const w={get(s,e){return V.get(s,e)},post(s,e,t){return V.post(s,e,t)},put(s,e,t){return V.put(s,e,t)},delete(s,e){return V.delete(s,e)},patch(s,e,t){return V.patch(s,e,t)},upload(s,e,t){const r=new FormData;return r.append("file",e),V.post(s,r,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a=>{if(t&&a.total){const o=Math.round(a.loaded*100/a.total);t(o)}}})},download(s,e,t){return V.get(s,{...t,responseType:"blob"}).then(r=>{const a=new Blob([r.data]),o=window.URL.createObjectURL(a),n=document.createElement("a");n.href=o,n.download=e||"download",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(o)})}},F={login(s){return w.post("/auth/login",s)},logout(){return w.post("/auth/logout")},register(s){return w.post("/auth/register",s)},getUserInfo(){return w.get("/auth/userinfo")},updateUserInfo(s){return w.put("/auth/userinfo",s)},changePassword(s){return w.put("/auth/password",s)},resetPassword(s){return w.post("/auth/reset-password",s)},refreshToken(){return w.post("/auth/refresh")},getCaptcha(){return w.get("/auth/captcha")},sendEmailCode(s){return w.post("/auth/send-email-code",{email:s})},sendSmsCode(s){return w.post("/auth/send-sms-code",{phone:s})},verifyEmail(s){return w.post("/auth/verify-email",s)},verifyPhone(s){return w.post("/auth/verify-phone",s)},bindThirdParty(s){return w.post("/auth/bind-third-party",s)},unbindThirdParty(s){return w.delete(`/auth/bind-third-party/${s}`)},getThirdPartyLoginUrl(s){return w.get(`/auth/third-party-login-url/${s}`)},thirdPartyLoginCallback(s){return w.post("/auth/third-party-login-callback",s)}},fe=ee("user",()=>{const s=v(null),e=v(""),t=v([]),r=v([]),a=f(()=>!!e.value&&!!s.value),o=f(()=>{var u;return((u=s.value)==null?void 0:u.username)||""}),n=f(()=>{var u;return((u=s.value)==null?void 0:u.nickname)||""}),i=f(()=>{var u;return((u=s.value)==null?void 0:u.avatar)||""}),h=async u=>{try{const d=await F.login(u),{token:g,userInfo:O}=d.data;return e.value=g,s.value=O,t.value=O.permissions||[],r.value=O.roles||[],localStorage.setItem(_.STORAGE_KEYS.TOKEN,g),localStorage.setItem(_.STORAGE_KEYS.USER_INFO,JSON.stringify(O)),d}catch(d){throw console.error("登录失败:",d),d}},y=async()=>{try{e.value&&await F.logout()}catch(u){console.warn("登出请求失败:",u)}finally{e.value="",s.value=null,t.value=[],r.value=[],localStorage.removeItem(_.STORAGE_KEYS.TOKEN),localStorage.removeItem(_.STORAGE_KEYS.USER_INFO)}},b=async()=>{try{if(!e.value)return;const d=(await F.getUserInfo()).data;return s.value=d,t.value=d.permissions||[],r.value=d.roles||[],localStorage.setItem(_.STORAGE_KEYS.USER_INFO,JSON.stringify(d)),d}catch(u){console.error("获取用户信息失败:",u),await y()}},S=async u=>{try{const g=(await F.updateUserInfo(u)).data;return s.value={...s.value,...g},localStorage.setItem(_.STORAGE_KEYS.USER_INFO,JSON.stringify(s.value)),g}catch(d){throw console.error("更新用户信息失败:",d),d}},m=u=>t.value.includes(u)||t.value.includes("*"),p=u=>r.value.includes(u)||r.value.includes("admin");return{userInfo:s,token:e,permissions:t,roles:r,isLoggedIn:a,username:o,nickname:n,avatar:i,login:h,logout:y,getUserInfo:b,updateUserInfo:S,hasPermission:m,hasRole:p,hasAnyPermission:u=>u.some(d=>m(d)),hasAnyRole:u=>u.some(d=>p(d)),initFromStorage:()=>{const u=localStorage.getItem(_.STORAGE_KEYS.TOKEN),d=localStorage.getItem(_.STORAGE_KEYS.USER_INFO);if(u&&(e.value=u),d)try{const g=JSON.parse(d);s.value=g,t.value=g.permissions||[],r.value=g.roles||[]}catch(g){console.warn("用户信息解析失败:",g),localStorage.removeItem(_.STORAGE_KEYS.USER_INFO)}}}},{persist:{key:_.STORAGE_KEYS.USER_INFO,storage:localStorage}}),je=ee("app",()=>{const s=v(!1),e=v(!1),t=v([]),r=v(""),a=v("zh-CN"),o=f(()=>s.value),n=f(()=>e.value),i=f(()=>a.value),h=d=>{s.value=d};return{loading:s,sidebarCollapsed:e,breadcrumbs:t,pageTitle:r,language:a,isLoading:o,isSidebarCollapsed:n,currentLanguage:i,setLoading:h,showLoading:()=>{h(!0)},hideLoading:()=>{h(!1)},toggleSidebar:()=>{e.value=!e.value},setSidebarCollapsed:d=>{e.value=d},setBreadcrumbs:d=>{t.value=d},addBreadcrumb:d=>{t.value.push(d)},setPageTitle:d=>{r.value=d,document.title=d?`${d} - 企业级低代码平台`:"企业级低代码平台"},setLanguage:d=>{a.value=d,localStorage.setItem("language",d)},initLanguage:()=>{const d=localStorage.getItem("language");if(d)a.value=d;else{const g=navigator.language||navigator.languages[0];a.value=g.startsWith("zh")?"zh-CN":"en-US"}}}},{persist:{key:"app_state",storage:localStorage}});class M{constructor(e,t,r,a=null){l(this,"dataSource");l(this,"dataObject");l(this,"metadata");l(this,"_value",v(null));l(this,"originalValue",null);l(this,"_errors",v([]));l(this,"_isValidating",v(!1));l(this,"valueChangeCallbacks",[]);l(this,"value",f({get:()=>this._value.value,set:e=>this.setValue(e)}));l(this,"errors",f(()=>this._errors.value));l(this,"hasErrors",f(()=>this._errors.value.length>0));l(this,"isValidating",f(()=>this._isValidating.value));l(this,"isChanged",f(()=>this._value.value!==this.originalValue));l(this,"isValid",f(()=>this._errors.value.length===0));this.dataSource=e,this.dataObject=t,this.metadata=r,this.originalValue=a,this._value.value=a??r.defaultValue??null,this.init()}init(){Z(this._value,(e,t)=>{this.valueChangeCallbacks.forEach(r=>{try{r(e)}catch(a){console.error("字段值变化回调执行失败:",a)}}),e!==t&&this.validate()},{immediate:!1})}setValue(e){const t=this.convertValue(e);this._value.value=t}getValue(){return this._value.value}convertValue(e){if(e==null)return null;switch(this.metadata.type){case"string":return String(e);case"number":const t=Number(e);return isNaN(t)?null:t;case"boolean":return typeof e=="boolean"?e:typeof e=="string"?e.toLowerCase()==="true"||e==="1":!!e;case"date":if(e instanceof Date)return e;if(typeof e=="string"||typeof e=="number"){const r=new Date(e);return isNaN(r.getTime())?null:r}return null;case"array":return Array.isArray(e)?e:[];case"object":return typeof e=="object"?e:{};default:return e}}async validate(){this._isValidating.value=!0;const e=[];try{const t=this._value.value,r=this.metadata.validation||[];for(const a of r){const o=await this.validateRule(t,a);o&&e.push(o)}return this._errors.value=e,e}catch(t){const r=t instanceof Error?t.message:"验证失败";return this._errors.value=[r],[r]}finally{this._isValidating.value=!1}}async validateRule(e,t){switch(t.type){case"required":if(this.isEmpty(e))return t.message||`${this.metadata.name}不能为空`;break;case"min":if(typeof e=="number"&&e<t.value)return t.message||`${this.metadata.name}不能小于${t.value}`;if(typeof e=="string"&&e.length<t.value)return t.message||`${this.metadata.name}长度不能小于${t.value}`;break;case"max":if(typeof e=="number"&&e>t.value)return t.message||`${this.metadata.name}不能大于${t.value}`;if(typeof e=="string"&&e.length>t.value)return t.message||`${this.metadata.name}长度不能大于${t.value}`;break;case"pattern":if(typeof e=="string"&&!new RegExp(t.value).test(e))return t.message||`${this.metadata.name}格式不正确`;break;case"custom":if(typeof t.value=="function")try{const r=await t.value(e,this);if(r!==!0)return typeof r=="string"?r:t.message||"验证失败"}catch{return t.message||"自定义验证失败"}break}return null}isEmpty(e){return e==null?!0:typeof e=="string"?e.trim()==="":Array.isArray(e)?e.length===0:typeof e=="object"?Object.keys(e).length===0:!1}reset(){this._value.value=this.originalValue,this._errors.value=[]}markAsClean(){this.originalValue=this._value.value}clearErrors(){this._errors.value=[]}addError(e){this._errors.value.includes(e)||this._errors.value.push(e)}onValueChange(e){this.valueChangeCallbacks.push(e)}offValueChange(e){const t=this.valueChangeCallbacks.indexOf(e);t>-1&&this.valueChangeCallbacks.splice(t,1)}getDisplayValue(){const e=this._value.value;if(e==null)return"";switch(this.metadata.type){case"date":if(e instanceof Date)return e.toLocaleDateString();break;case"number":if(typeof e=="number")return e.toLocaleString();break;case"boolean":return e?"是":"否";case"array":if(Array.isArray(e))return`[${e.length}项]`;break;case"object":if(typeof e=="object")return"[对象]";break}return String(e)}toJSON(){return{code:this.metadata.code,name:this.metadata.name,type:this.metadata.type,value:this._value.value,originalValue:this.originalValue,errors:this._errors.value,isChanged:this.isChanged.value,isValid:this.isValid.value}}destroy(){this.valueChangeCallbacks=[],this._errors.value=[]}}l(M,"ProvideKey",Symbol("DataField"));const z=class z{constructor(e,t,r,a={}){l(this,"dataSource");l(this,"id");l(this,"metadata");l(this,"fields",{});l(this,"originalData",{});l(this,"_isChanged",v(!1));l(this,"_isValid",v(!0));l(this,"_errors",v({}));l(this,"isChanged",f(()=>this._isChanged.value));l(this,"isValid",f(()=>this._isValid.value));l(this,"errors",f(()=>this._errors.value));l(this,"hasErrors",f(()=>Object.keys(this._errors.value).length>0));this.dataSource=e,this.id=t,this.metadata=r,this.originalData={...a},this.init(a)}init(e){Object.entries(this.metadata.fields).forEach(([t,r])=>{const a=e[t]??r.defaultValue;this.fields[t]=new M(this.dataSource,this,r,a)}),this.watchFieldChanges()}watchFieldChanges(){Object.values(this.fields).forEach(e=>{e.onValueChange(()=>{this.checkChanged(),this.validate()})})}checkChanged(){const e=this.getData();this._isChanged.value=JSON.stringify(e)!==JSON.stringify(this.originalData)}async validate(){const e={};let t=!0;for(const[r,a]of Object.entries(this.fields)){const o=await a.validate();o.length>0&&(e[r]=o,t=!1)}return this._errors.value=e,this._isValid.value=t,t}getFieldValue(e){const t=this.fields[e];return t?t.value.value:void 0}setFieldValue(e,t){const r=this.fields[e];return r?(r.setValue(t),!0):!1}getData(){const e={};return Object.entries(this.fields).forEach(([t,r])=>{e[t]=r.value.value}),e}setData(e){Object.entries(e).forEach(([t,r])=>{this.setFieldValue(t,r)})}reset(){this.setData(this.originalData),this._isChanged.value=!1,this._errors.value={},this._isValid.value=!0}markAsClean(){this.originalData={...this.getData()},this._isChanged.value=!1}clone(){return new z(this.dataSource,-1,this.metadata,this.getData())}getField(e){return this.fields[e]||null}getAllFields(){return Object.values(this.fields)}getChangedFields(){return Object.values(this.fields).filter(e=>e.isChanged.value)}getErrorFields(){return Object.values(this.fields).filter(e=>e.hasErrors.value)}toJSON(){return{id:this.id,metadata:this.metadata,data:this.getData(),isChanged:this.isChanged.value,isValid:this.isValid.value,errors:this.errors.value}}destroy(){Object.values(this.fields).forEach(e=>e.destroy()),this.fields={}}};l(z,"ProvideKey",Symbol("DataObject"));let x=z;class W{constructor(e){l(this,"option");l(this,"metadata",v(null));l(this,"objects",v([]));l(this,"loading",v(!1));l(this,"error",v(null));l(this,"isLoaded",f(()=>this.objects.value.length>0));l(this,"hasError",f(()=>!!this.error.value));this.option=e,this.init()}async init(){try{await this.loadMetadata(),this.option.autoLoad&&await this.load()}catch(e){this.error.value=e instanceof Error?e.message:"初始化失败",console.error("数据源初始化失败:",e)}}async loadMetadata(){if(this.option.type==="static"){this.metadata.value=this.option.metadata||{code:"static",name:"静态数据",fields:{}};return}const e=await w.get(`/metadata/${this.option.id}`);this.metadata.value=e.data.data}async load(){if(this.loading.value)return!1;this.loading.value=!0,this.error.value=null;try{let e=[];switch(this.option.type){case"static":e=this.option.data||[];break;case"api":e=(await this.fetchFromAPI()).data;break;case"mock":e=this.generateMockData();break;default:throw new Error(`不支持的数据源类型: ${this.option.type}`)}return this.objects.value=e.map((t,r)=>new x(this,r,this.metadata.value,t)),!0}catch(e){return this.error.value=e instanceof Error?e.message:"加载数据失败",console.error("数据加载失败:",e),!1}finally{this.loading.value=!1}}async fetchFromAPI(){const{url:e,method:t="GET",headers:r,params:a,data:o}=this.option;if(!e)throw new Error("API数据源缺少URL配置");const n={headers:r||{},params:a||{}};switch(t.toUpperCase()){case"GET":return(await w.get(e,n)).data;case"POST":return(await w.post(e,o,n)).data;case"PUT":return(await w.put(e,o,n)).data;case"DELETE":return(await w.delete(e,n)).data;default:throw new Error(`不支持的HTTP方法: ${t}`)}}generateMockData(){const e=[];for(let r=0;r<10;r++){const a={id:r+1};this.metadata.value&&Object.entries(this.metadata.value.fields).forEach(([o,n])=>{switch(n.type){case"string":a[o]=`${n.name}_${r+1}`;break;case"number":a[o]=Math.floor(Math.random()*100);break;case"boolean":a[o]=Math.random()>.5;break;case"date":a[o]=new Date;break;default:a[o]=null}}),e.push(a)}return e}async save(){if(this.option.readonly)throw new Error("只读数据源不支持保存操作");if(this.option.type==="static")return!0;this.loading.value=!0,this.error.value=null;try{const e=this.objects.value.filter(t=>t.isChanged.value).map(t=>t.getData());return e.length===0||(await w.post(`/data-source/${this.option.id}/save`,{data:e}),this.objects.value.forEach(t=>t.markAsClean())),!0}catch(e){return this.error.value=e instanceof Error?e.message:"保存数据失败",console.error("数据保存失败:",e),!1}finally{this.loading.value=!1}}addObject(e={}){const t=new x(this,this.objects.value.length,this.metadata.value,e);return this.objects.value.push(t),t}removeObject(e){return e>=0&&e<this.objects.value.length?(this.objects.value.splice(e,1),this.objects.value.forEach((t,r)=>{t.id=r}),!0):!1}clear(){this.objects.value=[],this.error.value=null}async refresh(){return this.clear(),await this.load()}getObject(e){return this.objects.value[e]||null}findObject(e){return this.objects.value.find(e)||null}filterObjects(e){return this.objects.value.filter(e)}destroy(){this.objects.value.forEach(e=>e.destroy()),this.objects.value=[],this.metadata.value=null,this.error.value=null}}l(W,"ProvideKey",Symbol("DataSource"));class se{constructor(e){l(this,"config");l(this,"executing",v(!1));l(this,"result",v(null));l(this,"error",v(null));l(this,"context",null);this.config=e}async execute(e={}){if(this.executing.value)throw new Error("数据流正在执行中");this.executing.value=!0,this.error.value=null,this.result.value=null;try{this.context={input:await this.getInputData(),variables:{},parameters:e,currentStep:0,totalSteps:this.config.steps.filter(r=>r.enabled).length};let t=this.context.input;for(const r of this.config.steps)r.enabled&&(this.context.currentStep++,t=await this.executeStep(r,t,this.context));return await this.handleOutput(t),this.result.value=t,t}catch(t){throw this.error.value=t instanceof Error?t.message:"数据流执行失败",console.error("数据流执行失败:",t),t}finally{this.executing.value=!1,this.context=null}}async getInputData(){var t;const{input:e}=this.config;switch(e.type){case"static":return e.data;case"dataSource":return e.source?[]:null;case"parameter":return((t=this.context)==null?void 0:t.parameters)||{};default:return null}}async executeStep(e,t,r){switch(e.type){case"transform":return this.executeTransform(e,t,r);case"filter":return this.executeFilter(e,t,r);case"validate":return this.executeValidate(e,t,r);case"custom":return this.executeCustom(e,t,r);default:throw new Error(`不支持的步骤类型: ${e.type}`)}}async executeTransform(e,t,r){const{config:a}=e;if(!Array.isArray(t))throw new Error("转换步骤需要数组类型的数据");switch(a.type){case"map":return t.map(o=>{const n={};return Object.entries(a.mapping||{}).forEach(([i,h])=>{n[i]=this.getNestedValue(o,h)}),n});case"aggregate":return this.aggregateData(t,a);case"sort":return this.sortData(t,a);case"group":return this.groupData(t,a);default:return t}}async executeFilter(e,t,r){const{config:a}=e;return Array.isArray(t)?t.filter(o=>this.evaluateCondition(o,a.condition,r)):t}async executeValidate(e,t,r){const{config:a}=e;if(a.schema&&!this.validateSchema(t,a.schema))throw new Error(`数据验证失败: ${e.name}`);return t}async executeCustom(e,t,r){const{config:a}=e;if(typeof a.handler=="function")return await a.handler(t,r);if(typeof a.code=="string")try{return await new Function("data","context",a.code)(t,r)}catch(o){throw new Error(`自定义步骤执行失败: ${o.message}`)}return t}async handleOutput(e){const{output:t}=this.config;switch(t.type){case"dataSource":t.target&&console.log("输出到数据源:",t.target,e);break;case"variable":t.target&&this.context&&(this.context.variables[t.target]=e);break}}getNestedValue(e,t){return t.split(".").reduce((r,a)=>r&&r[a]!==void 0?r[a]:null,e)}aggregateData(e,t){const{groupBy:r,aggregations:a}=t;if(!r){const n={};return Object.entries(a||{}).forEach(([i,h])=>{n[i]=this.applyAggregation(e,i,h)}),[n]}const o=this.groupData(e,{field:r});return Object.entries(o).map(([n,i])=>{const h={[r]:n};return Object.entries(a||{}).forEach(([y,b])=>{h[y]=this.applyAggregation(i,y,b)}),h})}applyAggregation(e,t,r){const a=e.map(o=>this.getNestedValue(o,t)).filter(o=>o!=null);switch(r){case"sum":return a.reduce((o,n)=>o+Number(n),0);case"avg":return a.length>0?a.reduce((o,n)=>o+Number(n),0)/a.length:0;case"count":return a.length;case"min":return Math.min(...a.map(Number));case"max":return Math.max(...a.map(Number));case"first":return a[0];case"last":return a[a.length-1];default:return null}}sortData(e,t){const{field:r,order:a="asc"}=t;return[...e].sort((o,n)=>{const i=this.getNestedValue(o,r),h=this.getNestedValue(n,r);return i<h?a==="asc"?-1:1:i>h?a==="asc"?1:-1:0})}groupData(e,t){const{field:r}=t;return e.reduce((a,o)=>{const n=String(this.getNestedValue(o,r));return a[n]||(a[n]=[]),a[n].push(o),a},{})}evaluateCondition(e,t,r){if(!t)return!0;const{field:a,operator:o,value:n}=t,i=this.getNestedValue(e,a);switch(o){case"eq":return i===n;case"ne":return i!==n;case"gt":return i>n;case"gte":return i>=n;case"lt":return i<n;case"lte":return i<=n;case"in":return Array.isArray(n)&&n.includes(i);case"nin":return Array.isArray(n)&&!n.includes(i);case"contains":return String(i).includes(String(n));case"startsWith":return String(i).startsWith(String(n));case"endsWith":return String(i).endsWith(String(n));default:return!0}}validateSchema(e,t){return t.type==="array"?Array.isArray(e):t.type==="object"?typeof e=="object"&&e!==null:!0}getProgress(){if(!this.context)return{current:0,total:0,percentage:0};const{currentStep:e,totalSteps:t}=this.context;return{current:e,total:t,percentage:t>0?Math.round(e/t*100):0}}stop(){this.executing.value=!1,this.context=null}clone(){return new se(JSON.parse(JSON.stringify(this.config)))}}var k=(s=>(s.Common="common",s.Input="input",s.Container="container",s.Collection="collection",s.Chart="chart",s.BI="bi",s.SVG="svg",s.Mobile="mobile",s.Custom="custom",s))(k||{}),oe=(s=>(s.Runtime="runtime",s.Designer="designer",s))(oe||{});class q{static build(e,t){const r={},a=(o,n)=>{const i={id:o.id,control:o,parent:n,children:[],type:"control"};return r[o.id]=i,o.children&&o.children.forEach(h=>{const y=a(h,i);i.children.push(y)}),i};return e.forEach(o=>a(o,t)),r}}const bt=[{type:k.Common,name:"基础组件",icon:"component",description:"常用的基础UI组件"},{type:k.Input,name:"输入组件",icon:"input",description:"表单输入相关组件"},{type:k.Container,name:"容器组件",icon:"container",description:"布局和容器组件"},{type:k.Collection,name:"集合组件",icon:"table",description:"数据展示和集合组件"},{type:k.Chart,name:"图表组件",icon:"chart",description:"数据可视化图表组件"},{type:k.BI,name:"大屏组件",icon:"dashboard",description:"数据大屏专用组件"},{type:k.SVG,name:"SVG组件",icon:"svg",description:"矢量图形组件"},{type:k.Mobile,name:"移动端组件",icon:"mobile",description:"移动端专用组件"},{type:k.Custom,name:"自定义组件",icon:"custom",description:"用户自定义组件"}],j={};function Le(s){j[s.kind]&&console.warn(`控件定义 ${s.kind} 已存在，将被覆盖`),j[s.kind]=s}function wt(s){s.forEach(e=>{Le(e)})}function _t(){return Object.values(j)}function Et(s){return Object.values(j).filter(e=>e.type===s)}function St(s){const e=s.toLowerCase();return Object.values(j).filter(t=>t.kindName.toLowerCase().includes(e)||t.kind.toLowerCase().includes(e))}const ge={ProvideKey:Symbol("ObjectMetadata")},ne={ProvideKey:Symbol("FieldMetadata")};class I{constructor(e,t=oe.Runtime,r){l(this,"page");l(this,"mode");l(this,"data");l(this,"_rootView",v());l(this,"_rootViewJson",v());l(this,"rootView",f({get:()=>this._rootView.value,set:e=>{this._rootView.value=e,this._rootViewJson.value=JSON.stringify(e,null,2)}}));l(this,"rootViewJson",f(()=>this._rootViewJson.value));l(this,"views",v([]));l(this,"viewIdMap",f(()=>{const e={};return this.views.value.forEach(t=>{e[t.id]=t}),e}));l(this,"dataSources",{defs:v({}),inst:v({})});l(this,"dataTransfers",{});l(this,"ctrlTree",v({}));l(this,"activeCtrls",v({}));l(this,"controlRefs",{});l(this,"instIdCounter",0);this.page=e,this.mode=t,this.data=r,this.init()}async init(){try{await this.loadPage(),await this.loadDataSources(),await this.loadDataTransfer(),this.makeControlTree()}catch(e){console.error("根视图上下文初始化失败:",e)}}async loadPage(){if(this.data)this.processDesignData(this.data);else{const e={rootView:{id:"root",name:"根视图",controls:[]},dataSources:{},dataTransfers:{}};this.processDesignData(e)}}processDesignData(e){this._rootView.value=e.rootView,this.views.value=e.rootView.views||[e.rootView],this.dataSources.defs.value=e.dataSources||{},Object.entries(e.dataTransfers||{}).forEach(([t,r])=>{this.dataTransfers[t]=new se(r)})}async loadDataSources(){const e=this.dataSources.defs.value,t={};for(const[r,a]of Object.entries(e))try{const o=new W(a);t[r]=o}catch(o){console.error(`数据源 ${r} 初始化失败:`,o)}this.dataSources.inst.value=t}async loadDataTransfer(){}makeControlTree(){var t,r;const e={};if((t=this._rootView.value)!=null&&t.controls){const a=q.build(this._rootView.value.controls);Object.assign(e,a)}if((r=this._rootView.value)!=null&&r.overlays){const a=q.build(this._rootView.value.overlays);Object.assign(e,a)}this.views.value.forEach(a=>{var o;if(a.id!==((o=this._rootView.value)==null?void 0:o.id)&&a.controls){const n=q.build(a.controls);Object.assign(e,n)}}),this.ctrlTree.value=e}findControl(e){const t=this.ctrlTree.value[e];return t?t.control:null}addCtrlRef(e,t,r,a){const o=`${e}_${t}`;this.controlRefs[o]={id:r.id,control:r,methods:a,viewId:e,instId:t}}removeCtrlRef(e,t){const r=`${e}_${t}`;delete this.controlRefs[r]}getControlRef(e){return Object.values(this.controlRefs).find(t=>t.id===e)}nextInstId(){return`inst_${++this.instIdCounter}`}setActiveControl(e,t){if(t){const r=this.findControl(t);r&&(this.activeCtrls.value[e]=r)}else delete this.activeCtrls.value[e]}clearActiveControl(e){delete this.activeCtrls.value[e]}addView(e){const t={id:`view_${Date.now()}`,name:"新视图",controls:[],...e};return this.views.value.push(t),t}removeView(e){const t=this.views.value.findIndex(r=>r.id===e);return t>-1?(this.views.value.splice(t,1),!0):!1}addControl(e,t,r={}){const a=this.viewIdMap.value[e];if(!a)throw new Error(`视图 ${e} 不存在`);const o={id:`${t}_${Date.now()}`,kind:t,name:r.name||t,classes:r.classes||[],styles:r.styles||{},dataBinding:r.dataBinding,eventExection:r.eventExection||{},children:r.children||[],...r};return a.controls.push(o),this.makeControlTree(),o}deleteControl(e,t){var n;const r=this.viewIdMap.value[e];if(!r)return!1;const a=i=>{for(let h=0;h<i.length;h++){if(i[h].id===t)return i.splice(h,1),!0;if(i[h].children&&a(i[h].children))return!0}return!1},o=a(r.controls);return o&&(this.makeControlTree(),((n=this.activeCtrls.value[e])==null?void 0:n.id)===t&&delete this.activeCtrls.value[e]),o}copyControl(e){console.log("复制控件:",e)}pasteControl(e,t){console.log("粘贴控件到视图:",e,"父控件:",t)}expandAllOutlineNodes(e){console.log("展开所有大纲节点:",e)}collapseAllOutlineNodes(e){console.log("折叠所有大纲节点:",e)}resetControlProperties(e){const t=this.findControl(e);t&&(t.styles={},t.classes=[],console.log("重置控件属性:",e))}copyControlProperties(e){console.log("复制控件属性:",e)}useMembers(){return{rootView:this.rootView,rootViewJson:this.rootViewJson,views:this.views,viewIdMap:this.viewIdMap,dataSources:this.dataSources,dataTransfers:this.dataTransfers,ctrlTree:this.ctrlTree,activeCtrls:this.activeCtrls}}destroy(){Object.values(this.dataSources.inst.value).forEach(e=>e.destroy()),Object.values(this.dataTransfers).forEach(e=>e.stop()),this.controlRefs={},this.views.value=[],this.ctrlTree.value={},this.activeCtrls.value={}}}l(I,"ProvideKey",Symbol("RootViewContext")),l(I,"ViewIdKey",Symbol("ViewId")),l(I,"RendererKey",Symbol("Renderer"));const ve=Symbol("ControlInstId");function $e(s,e){const t=f(()=>s.control),r=D(ve,"default"),a=D(I.ProvideKey,null),o=D(I.ViewIdKey,"default"),n=D(W.ProvideKey,null);D(ge.ProvideKey,null),D(ne.ProvideKey,null);const i=D(x.ProvideKey,null),h=D(M.ProvideKey,null),y=f({get:()=>{var m;return h!=null&&h.value?h.value.value.value:(m=t.value)==null?void 0:m.defaultValue},set:m=>{h!=null&&h.value&&(n!=null&&n.value)&&!n.value.option.readonly&&h.value.setValue(m)}}),b=()=>{var p;const m=(p=t.value)==null?void 0:p.dataBinding;if(m&&e)if(!m.inherit&&a){const E=a.dataSources.inst.value[m.source];E&&Me(E,m,e)}else m.inherit&&m.propertyCode&&Ke(m.propertyCode,e)},S=async(m,...p)=>{var T,c;const E=(c=(T=t.value)==null?void 0:T.eventExection)==null?void 0:c[m];if(E&&E.length>0)try{return await Fe(E,{control:t.value,dataSource:n==null?void 0:n.value,dataObject:i==null?void 0:i.value,dataField:h==null?void 0:h.value,args:p,ctx:a})}catch(u){return console.error("事件执行失败:",u),!1}return!0};return b(),{control:t,controlInstId:r,ctx:a,viewId:o,dataSource:n,dataField:h,value:y,eventHandler:S}}function Me(s,e,t){if(t(W.ProvideKey,ref(s)),e.objectCode){const r=s.objects.value.find(a=>a.metadata.code===e.objectCode);if(r&&(t(x.ProvideKey,ref(r)),t(ge.ProvideKey,ref(r.metadata)),e.propertyCode)){const a=r.getField(e.propertyCode);a&&(t(M.ProvideKey,ref(a)),t(ne.ProvideKey,ref(a.metadata)))}}}function Ke(s,e){const t=D(x.ProvideKey,null);if(t!=null&&t.value){const r=t.value.getField(s);r&&(e(M.ProvideKey,ref(r)),e(ne.ProvideKey,ref(r.metadata)))}}async function Fe(s,e){for(const t of s)if(!await Be(t,e))return!1;return!0}async function Be(s,e){const{type:t,target:r,method:a,params:o={}}=s;try{switch(t){case"control":return await He(r,a,o,e);case"dataSource":return await ze(r,a,o,e);case"dataTransfer":return await Ge(r,a,o,e);case"global":return await We(r,a,o,e);default:return console.warn(`未知的事件类型: ${t}`),!1}}catch(n){return console.error(`事件执行失败 [${t}:${r}:${a}]:`,n),!1}}async function He(s,e,t,r){var i;if(!r.ctx)return!1;const a=r.ctx.findControl(s);if(!a)return console.warn(`未找到目标控件: ${s}`),!1;const o=r.ctx.getControlRef(a.id);return(i=o==null?void 0:o.methods)!=null&&i[e]?await o.methods[e](t)!==!1:(console.warn(`控件 ${s} 不支持方法: ${e}`),!1)}async function ze(s,e,t,r){if(!r.ctx)return!1;const a=r.ctx.dataSources.inst.value[s];if(!a)return console.warn(`未找到数据源: ${s}`),!1;switch(e){case"load":return await a.load();case"save":return await a.save();case"refresh":return await a.refresh();case"clear":return a.clear(),!0;default:return console.warn(`数据源不支持方法: ${e}`),!1}}async function Ge(s,e,t,r){if(!r.ctx)return!1;const a=r.ctx.dataTransfers[s];if(!a)return console.warn(`未找到数据流: ${s}`),!1;switch(e){case"execute":return await a.execute(t)!==null;case"stop":return a.stop(),!0;default:return console.warn(`数据流不支持方法: ${e}`),!1}}async function We(s,e,t,r){switch(s){case"window":return Je(e,t);case"router":return Ye(e,t);case"message":return qe(e,t);default:return console.warn(`未知的全局目标: ${s}`),!1}}function Je(s,e){switch(s){case"open":return window.open(e.url,e.target||"_blank",e.features),!0;case"close":return window.close(),!0;case"reload":return window.location.reload(),!0;case"redirect":return window.location.href=e.url,!0;default:return!1}}function Ye(s,e){return console.log(`路由事件: ${s}`,e),!0}function qe(s,e){switch(s){case"success":return console.log("成功:",e.message),!0;case"error":return console.error("错误:",e.message),!0;case"warning":return console.warn("警告:",e.message),!0;case"info":return console.info("信息:",e.message),!0;default:return!1}}function Ze(s){const e={};if(!s.styles)return e;const t={width:"width",height:"height",minWidth:"min-width",minHeight:"min-height",maxWidth:"max-width",maxHeight:"max-height",position:"position",top:"top",right:"right",bottom:"bottom",left:"left",zIndex:"z-index",margin:"margin",marginTop:"margin-top",marginRight:"margin-right",marginBottom:"margin-bottom",marginLeft:"margin-left",padding:"padding",paddingTop:"padding-top",paddingRight:"padding-right",paddingBottom:"padding-bottom",paddingLeft:"padding-left",border:"border",borderTop:"border-top",borderRight:"border-right",borderBottom:"border-bottom",borderLeft:"border-left",borderWidth:"border-width",borderStyle:"border-style",borderColor:"border-color",borderRadius:"border-radius",background:"background",backgroundColor:"background-color",backgroundImage:"background-image",backgroundSize:"background-size",backgroundPosition:"background-position",backgroundRepeat:"background-repeat",fontSize:"font-size",fontWeight:"font-weight",fontFamily:"font-family",fontStyle:"font-style",lineHeight:"line-height",textAlign:"text-align",textDecoration:"text-decoration",color:"color",display:"display",visibility:"visibility",opacity:"opacity",overflow:"overflow",overflowX:"overflow-x",overflowY:"overflow-y",flexDirection:"flex-direction",flexWrap:"flex-wrap",justifyContent:"justify-content",alignItems:"align-items",alignContent:"align-content",flex:"flex",flexGrow:"flex-grow",flexShrink:"flex-shrink",flexBasis:"flex-basis",alignSelf:"align-self",order:"order",gridTemplateColumns:"grid-template-columns",gridTemplateRows:"grid-template-rows",gridColumn:"grid-column",gridRow:"grid-row",gridArea:"grid-area",gap:"gap",transform:"transform",transformOrigin:"transform-origin",transition:"transition",boxShadow:"box-shadow",textShadow:"text-shadow",cursor:"cursor",userSelect:"user-select",pointerEvents:"pointer-events"};return Object.entries(s.styles).forEach(([r,a])=>{const o=t[r]||r;a!=null&&a!==""&&(e[o]=Qe(r,a))}),e}function Qe(s,e){return typeof e=="number"&&["width","height","minWidth","minHeight","maxWidth","maxHeight","top","right","bottom","left","margin","marginTop","marginRight","marginBottom","marginLeft","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","borderWidth","borderRadius","fontSize","lineHeight","gap"].includes(s)?`${e}px`:String(e)}const Xe=G({__name:"control-renderer",props:{control:{},zoom:{default:1}},setup(s,{expose:e}){const t=s,{viewId:r,control:a,ctx:o,eventHandler:n}=$e(t,$),i=f(()=>{var c;return j[(c=a.value)==null?void 0:c.kind]}),h=f(()=>{var c;return((c=i.value)==null?void 0:c.component)||"div"}),y=f(()=>{const c=[...a.value.classes||[]];return a.value.kind&&c.push(`ctrl-${a.value.kind}`),c}),b=f(()=>{const c=Ze(a.value);return t.zoom&&t.zoom!==1&&(c.zoom=t.zoom),c}),S=f(()=>{const c={};return a.value.props&&Object.assign(c,a.value.props),c}),m=f(()=>{var c;return(c=i.value)!=null&&c.events?Object.keys(i.value.events):[]}),p=async(c,...u)=>{try{return await(n==null?void 0:n(c,...u))}catch(d){return console.error(`控件事件处理失败 [${a.value.kind}:${c}]:`,d),!1}},E=(o==null?void 0:o.nextInstId())||"default";$(ve,E);const T=v();return te(()=>{var c;o&&r&&o.addCtrlRef(r,E,a.value,(c=T.value)==null?void 0:c.methods),setTimeout(()=>{n==null||n("mounted")},0)}),de(()=>{o&&r&&o.removeCtrlRef(r,E),n==null||n("unmounted")}),e({control:a.value,element:T,focus:()=>{var c,u;return(u=(c=T.value)==null?void 0:c.focus)==null?void 0:u.call(c)},blur:()=>{var c,u;return(u=(c=T.value)==null?void 0:c.blur)==null?void 0:u.call(c)},validate:()=>{var c,u;return(u=(c=T.value)==null?void 0:c.validate)==null?void 0:u.call(c)},reset:()=>{var c,u;return(u=(c=T.value)==null?void 0:c.reset)==null?void 0:u.call(c)},getValue:()=>{var c,u;return(u=(c=T.value)==null?void 0:c.getValue)==null?void 0:u.call(c)},setValue:c=>{var u,d;return(d=(u=T.value)==null?void 0:u.setValue)==null?void 0:d.call(u,c)}}),(c,u)=>(C(!0),R(X,null,Q(m.value,d=>(C(),B(H(h.value),Ee({ref_for:!0,ref_key:"ctrlInst",ref:T,control:Te(a),class:y.value,style:b.value},{ref_for:!0},S.value,{[Se(d)]:p},{key:`event-${d}`}),null,16,["control","class","style"]))),128))}}),et=ae(Xe,[["__scopeId","data-v-0ef38cda"]]),tt={key:0,class:"loading-container"},rt={key:1,class:"error-container"},at={key:0,class:"view-content"},st={key:1,class:"overlay-content"},ot={key:3,class:"empty-container"},Tt=G({__name:"root-view-renderer",props:{page:{},mode:{default:oe.Runtime},data:{}},setup(s,{expose:e}){const t=s,r=v(!0),a=v(null),o=v(null),n=v(""),i=v(1),h=f(()=>{var g;return(g=o.value)==null?void 0:g.rootView}),y=f(()=>!o.value||!n.value?null:o.value.viewIdMap.value[n.value]),b=f(()=>{var g,O;return((g=y.value)==null?void 0:g.id)===((O=h.value)==null?void 0:O.id)}),S=f(()=>["root-view-renderer",`mode-${t.mode}`,{"is-loading":r.value,"has-error":!!a.value,"is-root-view":b.value}]),m=f(()=>{const g={};return i.value!==1&&(g.zoom=i.value),g}),p=f(()=>et),E={props:["context","viewId"],setup(g,{slots:O}){return $(I.ProvideKey,g.context),$(I.ViewIdKey,g.viewId),$(I.RendererKey,p.value),()=>{var K;return(K=O.default)==null?void 0:K.call(O)}}},T=async()=>{r.value=!0,a.value=null;try{const g=new I(t.page,t.mode,t.data);o.value=g,g.views.value.length>0&&(n.value=g.views.value[0].id),r.value=!1}catch(g){a.value=g instanceof Error?g.message:"初始化失败",r.value=!1,console.error("根视图渲染器初始化失败:",g)}},c=()=>{T()},u=g=>{var O;(O=o.value)!=null&&O.viewIdMap.value[g]&&(n.value=g)},d=g=>{i.value=Math.max(.1,Math.min(5,g))};return Z(()=>t.page,T,{immediate:!1}),Z(()=>t.data,T,{immediate:!1}),te(()=>{T()}),de(()=>{o.value&&o.value.destroy()}),e({context:f(()=>o.value),currentView:y,currentViewId:f(()=>n.value),loading:f(()=>r.value),error:f(()=>a.value),switchView:u,setZoom:d,retry:c}),(g,O)=>{const K=P("a-spin"),me=P("a-button"),pe=P("a-result"),ye=P("a-empty");return C(),R("div",{class:ue(["root-view-renderer",S.value]),style:Oe(m.value)},[r.value?(C(),R("div",tt,[U(K,{size:"large",tip:"加载中..."})])):a.value?(C(),R("div",rt,[U(pe,{status:"error",title:"加载失败","sub-title":a.value},{extra:J(()=>[U(me,{type:"primary",onClick:c},{default:J(()=>O[0]||(O[0]=[Ce("重试")])),_:1,__:[0]})]),_:1},8,["sub-title"])])):o.value?(C(),B(H(E),{key:2,context:o.value,"view-id":n.value},{default:J(()=>[y.value?(C(),R("div",at,[(C(!0),R(X,null,Q(y.value.controls,L=>(C(),B(H(p.value),{key:L.id,control:L,zoom:i.value},null,8,["control","zoom"]))),128))])):ie("",!0),b.value&&h.value.overlays?(C(),R("div",st,[(C(!0),R(X,null,Q(h.value.overlays,L=>(C(),B(H(p.value),{key:L.id,control:L,zoom:i.value},null,8,["control","zoom"]))),128))])):ie("",!0)]),_:1},8,["context","view-id"])):(C(),R("div",ot,[U(ye,{description:"暂无内容"})]))],6)}}});function nt(s=[],e=[]){const t=[{path:"/",redirect:"/dashboard"},...s,...e];return De({history:Ve(),routes:t,scrollBehavior(r,a,o){return o||{top:0}}})}function it(s){s.config.globalProperties.$global=re,s.config.errorHandler=(e,t,r)=>{console.error("应用错误:",e),console.error("错误信息:",r),console.error("组件实例:",t)},s.config.warnHandler=(e,t,r)=>{console.warn("应用警告:",e),console.warn("组件实例:",t),console.warn("组件追踪:",r)}}function lt(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(s=>{console.log("SW registered: ",s)}).catch(s=>{console.log("SW registration failed: ",s)})})}async function ct(s,e=[],t=[],r){document.title=re.title;const a=Re(Pe),o=Ae();o.use(ke),a.use(o),a.use(xe);const n=nt(e,t);return a.use(n),it(a),he().init(),r&&r(a),lt(),a.mount(s),{app:a,router:n,pinia:o}}const ut="modulepreload",dt=function(s){return"/"+s},ce={},N=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){let n=function(y){return Promise.all(y.map(b=>Promise.resolve(b).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),h=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=n(t.map(y=>{if(y=dt(y),y in ce)return;ce[y]=!0;const b=y.endsWith(".css"),S=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${S}`))return;const m=document.createElement("link");if(m.rel=b?"stylesheet":ut,b||(m.as="script"),m.crossOrigin="",m.href=y,h&&m.setAttribute("nonce",h),document.head.appendChild(m),b)return new Promise((p,E)=>{m.addEventListener("load",p),m.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${y}`)))})}))}function o(n){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=n,window.dispatchEvent(i),!i.defaultPrevented)throw n}return a.then(n=>{for(const i of n||[])i.status==="rejected"&&o(i.reason);return e().catch(o)})},ht=[{path:"/",redirect:"/designer"},{path:"/designer",name:"Designer",component:()=>N(()=>import("./Designer.DTlVBRjO.js"),__vite__mapDeps([0,1,2,3,4,5])),meta:{title:"设计器",requiresAuth:!0}},{path:"/designer/:id",name:"DesignerEdit",component:()=>N(()=>import("./Designer.DTlVBRjO.js"),__vite__mapDeps([0,1,2,3,4,5])),meta:{title:"编辑页面",requiresAuth:!0}},{path:"/designer-test",name:"DesignerTest",component:()=>N(()=>import("./DesignerTest.CuGvBXwu.js"),__vite__mapDeps([6,1,2,3,7])),meta:{title:"设计器测试",requiresAuth:!1}},{path:"/preview/:id",name:"Preview",component:()=>N(()=>import("./Preview.BrZvWUA6.js"),__vite__mapDeps([8,1,9,5,2,3,10])),meta:{title:"预览页面",requiresAuth:!1}},{path:"/login",name:"Login",component:()=>N(()=>import("./Login.CrN9F06U.js"),__vite__mapDeps([11,1,9,5,2,3,12])),meta:{title:"登录",requiresAuth:!1}},{path:"/:pathMatch(.*)*",name:"NotFound",component:()=>N(()=>import("./NotFound.B6y6t685.js"),__vite__mapDeps([13,1,9,5,2,3,14])),meta:{title:"页面不存在"}}],ft={id:"designer-app",class:"h-full"},gt=G({__name:"App",setup(s){const e=je();return te(()=>{e.setPageTitle("设计器")}),(t,r)=>{const a=P("router-view");return C(),R("div",ft,[U(a)])}}}),vt=ae(gt,[["__scopeId","data-v-45fc79b1"]]);ct("#app",ht,[],s=>{s.component("DesignerApp",vt)});export{j as C,I as R,ae as _,bt as a,Et as b,k as c,Tt as d,_t as g,wt as r,St as s,$e as u};
